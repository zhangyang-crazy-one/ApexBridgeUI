<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plugin Store Demo - VCPChat</title>

  <!-- Main Styles -->
  <link rel="stylesheet" href="/src/styles/main.css">
  <link rel="stylesheet" href="/src/styles/plugin-store.css">

  <style>
    body {
      margin: 0;
      padding: 0;
      background: var(--bg-secondary);
      font-family: var(--font-body);
    }

    .demo-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: var(--spacing-xl);
    }

    .demo-header {
      margin-bottom: var(--spacing-xl);
      padding: var(--spacing-lg);
      background: var(--bg-primary);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-color);
    }

    .demo-title {
      font-family: var(--font-heading);
      font-size: var(--font-size-2xl);
      color: var(--text-primary);
      margin: 0 0 var(--spacing-sm) 0;
    }

    .demo-subtitle {
      font-family: var(--font-body);
      font-size: var(--font-size-base);
      color: var(--text-secondary);
      margin: 0;
    }

    .demo-controls {
      display: flex;
      gap: var(--spacing-md);
      margin-top: var(--spacing-md);
    }

    .theme-toggle-btn {
      padding: var(--spacing-sm) var(--spacing-md);
      font-family: var(--font-heading);
      font-size: var(--font-size-sm);
      color: var(--text-primary);
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .theme-toggle-btn:hover {
      background: var(--bg-tertiary);
      border-color: var(--border-hover);
    }

    #pluginStoreContainer {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div class="demo-container">
    <div class="demo-header">
      <h1 class="demo-title">Plugin Store UI Demo</h1>
      <p class="demo-subtitle">
        Anthropic/Claude.ai design system compliant plugin marketplace interface
      </p>
      <div class="demo-controls">
        <button class="theme-toggle-btn" id="themeToggleBtn">
          Toggle Theme (Current: <span id="currentTheme">Light</span>)
        </button>
      </div>
    </div>

    <!-- Plugin Store Container -->
    <div id="pluginStoreContainer"></div>
  </div>

  <script type="module">
    import { initPluginStore } from '/src/modules/settings/plugin-store.ts';

    // Theme toggle functionality
    const themeToggleBtn = document.getElementById('themeToggleBtn');
    const currentThemeSpan = document.getElementById('currentTheme');

    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme') || 'light';
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';

      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('vcpchat-theme', newTheme);

      currentThemeSpan.textContent = newTheme.charAt(0).toUpperCase() + newTheme.slice(1);

      console.log('[Demo] Theme switched to:', newTheme);
    }

    themeToggleBtn.addEventListener('click', toggleTheme);

    // Load saved theme on start
    const savedTheme = localStorage.getItem('vcpchat-theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    currentThemeSpan.textContent = savedTheme.charAt(0).toUpperCase() + savedTheme.slice(1);

    // Initialize Plugin Store
    async function initDemo() {
      try {
        console.log('[Demo] Initializing Plugin Store...');

        const pluginStore = await initPluginStore('pluginStoreContainer');

        console.log('[Demo] Plugin Store initialized successfully');
        console.log('[Demo] Available plugins:', pluginStore);

      } catch (error) {
        console.error('[Demo] Failed to initialize Plugin Store:', error);

        // Show error message in container
        const container = document.getElementById('pluginStoreContainer');
        container.innerHTML = `
          <div style="padding: var(--spacing-xl); text-align: center;">
            <h3 style="color: var(--text-primary); font-family: var(--font-heading);">
              Failed to Initialize Plugin Store
            </h3>
            <p style="color: var(--text-secondary); font-family: var(--font-body);">
              ${error.message || error}
            </p>
            <button onclick="location.reload()" style="
              padding: var(--spacing-sm) var(--spacing-md);
              font-family: var(--font-heading);
              background: var(--active-bg);
              color: var(--active-text);
              border: none;
              border-radius: var(--radius-sm);
              cursor: pointer;
            ">
              Reload Page
            </button>
          </div>
        `;
      }
    }

    // Start demo on page load
    document.addEventListener('DOMContentLoaded', initDemo);
  </script>
</body>
</html>
