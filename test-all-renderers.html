<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VCPChat - All 21 Renderers Test</title>
  <link rel="stylesheet" href="/src/styles/main.css">
  <style>
    body {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .test-section {
      margin-bottom: 40px;
      padding: 20px;
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      background: var(--bg-primary);
    }

    .test-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--border-color);
    }

    .test-title {
      font-family: var(--font-heading);
      font-size: var(--font-size-xl);
      font-weight: 500;
      color: var(--text-primary);
    }

    .test-status {
      padding: 4px 12px;
      border-radius: var(--radius-sm);
      font-size: var(--font-size-xs);
      font-weight: 500;
    }

    .test-status.pass {
      background: #42A592;
      color: white;
    }

    .test-status.fail {
      background: #E74C3C;
      color: white;
    }

    .test-status.pending {
      background: #F39C12;
      color: white;
    }

    .test-content {
      margin-top: 12px;
      padding: 12px;
      background: var(--bg-secondary);
      border-radius: var(--radius-sm);
      min-height: 100px;
    }

    .test-input {
      margin-bottom: 12px;
      padding: 8px;
      background: var(--bg-tertiary);
      border-radius: var(--radius-sm);
      font-family: monospace;
      font-size: 13px;
      color: var(--text-secondary);
      white-space: pre-wrap;
      word-break: break-all;
    }

    .summary {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      min-width: 200px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .summary h3 {
      margin: 0 0 12px 0;
      font-size: var(--font-size-lg);
    }

    .summary-stats {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      font-size: var(--font-size-sm);
    }
  </style>
</head>
<body>
  <div class="summary">
    <h3>Test Summary</h3>
    <div class="summary-stats">
      <div class="stat-row">
        <span>Total:</span>
        <strong id="total-count">21</strong>
      </div>
      <div class="stat-row" style="color: #42A592;">
        <span>Passed:</span>
        <strong id="pass-count">0</strong>
      </div>
      <div class="stat-row" style="color: #E74C3C;">
        <span>Failed:</span>
        <strong id="fail-count">0</strong>
      </div>
      <div class="stat-row" style="color: #F39C12;">
        <span>Pending:</span>
        <strong id="pending-count">21</strong>
      </div>
    </div>
  </div>

  <h1 style="margin-bottom: 32px; font-family: var(--font-heading);">VCPChat - All 21 Renderers Test</h1>

  <!-- Test sections will be inserted here -->
  <div id="test-container"></div>

  <script type="module">
    import { getMessageRenderer } from '/src/core/renderer/messageRenderer.ts';

    const testCases = [
      {
        name: '1. Markdown Renderer',
        content: '# Hello World\n\nThis is **bold** and *italic* text.\n\n- List item 1\n- List item 2\n\n[Link](https://example.com)',
        description: 'Tests markdown parsing with headings, bold, italic, lists, and links'
      },
      {
        name: '2. Code Renderer',
        content: '```javascript\nconst greeting = "Hello, World!";\nconsole.log(greeting);\n\nfunction add(a, b) {\n  return a + b;\n}\n```',
        description: 'Tests syntax-highlighted code blocks'
      },
      {
        name: '3. LaTeX Renderer',
        content: 'Inline formula: $E = mc^2$\n\nDisplay formula:\n$$\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}$$',
        description: 'Tests LaTeX mathematical formulas (inline and display)'
      },
      {
        name: '4. HTML Renderer',
        content: '<div style="padding: 16px; border: 2px solid #42A592; border-radius: 8px;">\n  <h2>HTML Content</h2>\n  <p>This is <strong>rendered HTML</strong>.</p>\n</div>',
        description: 'Tests safe HTML rendering'
      },
      {
        name: '5. Mermaid Renderer',
        content: '```mermaid\ngraph TD\n    A[Start] -->|Step 1| B(Process)\n    B --> C{Decision}\n    C -->|Yes| D[End]\n    C -->|No| B\n```',
        description: 'Tests Mermaid diagram rendering'
      },
      {
        name: '6. Three.js Renderer',
        content: '```threejs\nsphere(1, 32, 32)\nbox(2, 2, 2)\ncylinder(0.5, 0.5, 2)\n```',
        description: 'Tests Three.js 3D graphics rendering'
      },
      {
        name: '7. JSON Renderer',
        content: '```json\n{\n  "name": "VCPChat",\n  "version": "1.0.0",\n  "features": ["AI", "Rendering", "Plugins"],\n  "active": true\n}\n```',
        description: 'Tests JSON syntax highlighting with collapsible tree'
      },
      {
        name: '8. XML Renderer',
        content: '<?xml version="1.0" encoding="UTF-8"?>\n<config>\n  <database>\n    <host>localhost</host>\n    <port>5432</port>\n  </database>\n</config>',
        description: 'Tests XML syntax highlighting'
      },
      {
        name: '9. CSV Renderer',
        content: 'Name,Age,City,Status\nJohn Doe,30,New York,Active\nJane Smith,25,Los Angeles,Active\nBob Johnson,35,Chicago,Inactive',
        description: 'Tests CSV table rendering'
      },
      {
        name: '10. Image Renderer',
        content: 'https://via.placeholder.com/400x300.png?text=VCPChat+Image+Test',
        description: 'Tests lazy-loaded image rendering'
      },
      {
        name: '11. Video Renderer',
        content: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
        description: 'Tests video player embedding'
      },
      {
        name: '12. Audio Renderer',
        content: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3',
        description: 'Tests audio player embedding'
      },
      {
        name: '13. PDF Renderer',
        content: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
        description: 'Tests PDF viewer embedding'
      },
      {
        name: '14. Diff Renderer',
        content: '```diff\n--- a/file.txt\n+++ b/file.txt\n@@ -1,5 +1,5 @@\n function hello() {\n-  console.log("old");\n+  console.log("new");\n   return true;\n }\n```',
        description: 'Tests git diff visualization'
      },
      {
        name: '15. YAML Renderer',
        content: '```yaml\nname: VCPChat\nversion: 1.0.0\nfeatures:\n  - ai_chat\n  - rendering\n  - plugins\nsettings:\n  theme: light\n  language: en\n```',
        description: 'Tests YAML syntax highlighting'
      },
      {
        name: '16. GraphQL Renderer',
        content: '```graphql\nquery GetUser($id: ID!) {\n  user(id: $id) {\n    name\n    email\n    posts {\n      title\n      content\n    }\n  }\n}\n```',
        description: 'Tests GraphQL syntax highlighting'
      },
      {
        name: '17. SQL Renderer',
        content: '```sql\nSELECT u.name, u.email, COUNT(p.id) as post_count\nFROM users u\nLEFT JOIN posts p ON u.id = p.user_id\nWHERE u.status = \'active\'\nGROUP BY u.id\nORDER BY post_count DESC;\n```',
        description: 'Tests SQL syntax highlighting'
      },
      {
        name: '18. Regex Renderer',
        content: '/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/i',
        description: 'Tests regex pattern visualization'
      },
      {
        name: '19. ASCII Art Renderer',
        content: '```\n     *****\n   *********\n  ***********\n *************\n***************\n *************\n  ***********\n   *********\n     *****\n```',
        description: 'Tests ASCII art rendering'
      },
      {
        name: '20. Color Renderer',
        content: '#FF5733 rgb(66, 165, 146) hsl(120, 60%, 70%)',
        description: 'Tests color swatch rendering'
      },
      {
        name: '21. URL Renderer',
        content: 'Check out https://www.anthropic.com for more information about Claude!',
        description: 'Tests automatic URL linkification'
      }
    ];

    async function runTests() {
      const container = document.getElementById('test-container');
      const renderer = getMessageRenderer();

      let passCount = 0;
      let failCount = 0;
      let pendingCount = testCases.length;

      for (let i = 0; i < testCases.length; i++) {
        const test = testCases[i];

        // Create test section
        const section = document.createElement('div');
        section.className = 'test-section';
        section.id = `test-${i}`;

        const header = document.createElement('div');
        header.className = 'test-header';

        const title = document.createElement('div');
        title.className = 'test-title';
        title.textContent = test.name;

        const status = document.createElement('div');
        status.className = 'test-status pending';
        status.textContent = 'PENDING';

        header.appendChild(title);
        header.appendChild(status);

        const description = document.createElement('div');
        description.style.fontSize = '14px';
        description.style.color = 'var(--text-secondary)';
        description.style.marginTop = '8px';
        description.textContent = test.description;

        const input = document.createElement('div');
        input.className = 'test-input';
        input.textContent = `Input: ${test.content.substring(0, 100)}${test.content.length > 100 ? '...' : ''}`;

        const contentDiv = document.createElement('div');
        contentDiv.className = 'test-content';
        contentDiv.textContent = 'Testing...';

        section.appendChild(header);
        section.appendChild(description);
        section.appendChild(input);
        section.appendChild(contentDiv);
        container.appendChild(section);

        // Run test
        try {
          const message = {
            id: `test-${i}-${Date.now()}`,
            content: test.content,
            sender: 'assistant',
            sender_id: 'test-assistant',
            sender_name: 'Test Assistant',
            timestamp: new Date().toISOString(),
            is_streaming: false
          };

          const result = await renderer.renderMessage(message);

          if (result && result.refs && result.refs.contentZone) {
            contentDiv.innerHTML = '';
            contentDiv.appendChild(result.refs.contentZone);
            status.className = 'test-status pass';
            status.textContent = '✓ PASS';
            passCount++;
            pendingCount--;
          } else {
            throw new Error('No content zone returned');
          }
        } catch (error) {
          contentDiv.innerHTML = `<div style="color: #E74C3C; font-family: monospace;">Error: ${error.message}</div>`;
          status.className = 'test-status fail';
          status.textContent = '✗ FAIL';
          failCount++;
          pendingCount--;
        }

        // Update summary
        document.getElementById('pass-count').textContent = passCount;
        document.getElementById('fail-count').textContent = failCount;
        document.getElementById('pending-count').textContent = pendingCount;

        // Small delay to show progress
        await new Promise(resolve => setTimeout(resolve, 100));
      }

      console.log('All tests completed!');
      console.log(`Passed: ${passCount}/${testCases.length}`);
      console.log(`Failed: ${failCount}/${testCases.length}`);
    }

    // Run tests on load
    window.addEventListener('load', () => {
      setTimeout(runTests, 500);
    });
  </script>
</body>
</html>
